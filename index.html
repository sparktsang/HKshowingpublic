<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <title>香港即日上映電影</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.6/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: #f9f9f9;
            color: #333;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        header {
            background: #1a1a1a;
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 1rem;
        }
        p { text-align: center; }
        .update-info {
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
        }
        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 1rem;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #333;
            color: white;
        }
        tr:hover {
            background: #f0f0f0;
        }
        .loading {
            text-align: center;
            font-size: 1.5rem;
            margin: 2rem 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>香港即日上映電影數據 - 每日更新</h1>
    </header>
  	<p>以下係最新嘅香港上映電影列表及其爛蕃茄數據，每日清晨自動更新一次。</p>
    <p>各人揀睇咩戲，都有自己方式。而我呢，就係睇爛蕃茄影評人分數Tomatometer。呢個分數代表一堆專業影評人，畀一部戲正評嘅比例。唔好誤會，佢唔可以準確咁評一部戲有幾好㗎！但佢可以防伏：越大比例嘅專業影評人正評，同埋越多影評人參與嗰個評分，伏嘅機會越低。當然要結合自己對劇情同類型嘅偏好。但防伏率確實好高！可以睇埋Audience Score一併參考，觀眾評價數目仲可以睇得出部戲有幾熱門添！</p>

    <main>
        <div class="update-info" id="updateDate">加載中...</div>

        <div class="table-container" id="tableContainer">
            <p class="loading" id="loading">正在載入數據...</p>
            <table id="excelTable" style="display: none;"></table>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const repoOwner = 'sparktsang';
            const repoName = 'HKshowingpublic';
            const branchName = 'gh-pages';

            fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/${branchName}/manifest.json`)
                .then(response => response.json())
                .then(data => {
                    const latestFileName = data.latest;
                    const updateDate = latestFileName.match(/\d{4}-\d{2}-\d{2}/)[0];
                    document.getElementById('updateDate').textContent = `${updateDate} (最近更新)`;

                    return fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/${branchName}/${latestFileName}`);
                })
                .then(response => response.arrayBuffer())
                .then(data => {
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const htmlString = XLSX.utils.sheet_to_html(worksheet, { id: 'excelTable' });

                    document.getElementById('excelTable').outerHTML = htmlString;
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('excelTable').style.display = 'table';
                })
                .catch(error => {
                    console.error('Error loading data:', error);
                    document.getElementById('loading').textContent = '數據載入失敗，請稍後再試。';
                });
        });
    </script>
    <p>註：不包括放映戲院及場次過少、及爛蕃茄數據不完整的電影。「上映日期」代表幾時喺香港上畫。數據力求準確，但無法就不準負責。感謝參考！</p>
    <p>假如幫你揀到部好電影想答謝我，不妨獎我一杯咖啡！以下係Payme link，非常感謝！</p>
    <p><a href="https://payme.hsbc/sparktsang">https://payme.hsbc/sparktsang</a></p>
</body>
</html>
