<!DOCTYPE html>
<html>
<head>
    <title>香港現在上映電影</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.6/xlsx.full.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        h1 { text-align: center; }
        p { text-align: center; }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>香港現在上映電影數據 - 每週更新</h1>
    <p>以下係最新嘅香港上映電影列表及其爛蕃茄數據，每週自動更新一次。</p>
    <p>各人揀睇咩戲，都有自己方式。而我呢，就係睇爛蕃茄影評人分數。呢個分數代表一堆專業影評人，畀一部戲正評嘅比例。唔好誤會，佢唔可以準確咁評一部戲有幾好㗎！但佢可以防伏：越大比例嘅專業影評人正評，同埋越多影評人參與嗰個評分，伏嘅機會越低。唔係百分百㗎，要結合自己對戲情同類型嘅偏好。但防伏率確實好高！依家，我將呢個數據分享出嚟，有興趣不妨參考下啦。</p>

    <h2 style="text-align: center;">最新更新 (2025-03-23)</h2>
    <table id="excelTable"></table>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            fetch('香港現在上映電影 2025-03-23.xlsx')
                .then(response => response.arrayBuffer())
                .then(data => {
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];

                    // 過濾掉隱藏的列
                    const range = XLSX.utils.decode_range(worksheet['!ref']);
                    for (let C = range.s.c; C <= range.e.c; ++C) {
                        const address = XLSX.utils.encode_col(C) + "1";
                        if (worksheet[address] && worksheet[address].hidden) {
                            for (let R = range.s.r; R <= range.e.r; ++R) {
                                const cell_address = XLSX.utils.encode_cell({ r: R, c: C });
                                delete worksheet[cell_address];
                            }
                        }
                    }

                    const htmlString = XLSX.utils.sheet_to_html(worksheet, { id: 'excelTable' });
                    document.getElementById('excelTable').outerHTML = htmlString;
                })
                .catch(error => console.error(error));
        });
    </script>
</body>
</html>
